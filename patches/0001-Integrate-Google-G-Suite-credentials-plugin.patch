From 0430f5053c21a425e546154dada7f8baf2d8b157 Mon Sep 17 00:00:00 2001
From: Christian Simon <simon@swine.de>
Date: Wed, 27 Mar 2019 15:23:57 +0000
Subject: [PATCH 1/4] Integrate Google G Suite credentials plugin

Easier way of running the plugin without the stateful plugin setup
---
 go.mod                            | 1 +
 go.sum                            | 2 ++
 helper/builtinplugins/registry.go | 2 ++
 3 files changed, 5 insertions(+)

diff --git a/go.mod b/go.mod
index e85f8ab9e..f8bc9f40c 100644
--- a/go.mod
+++ b/go.mod
@@ -113,6 +113,7 @@ require (
 	github.com/samuel/go-zookeeper v0.0.0-20180130194729-c4fab1ac1bec
 	github.com/shopspring/decimal v0.0.0-20180709203117-cd690d0c9e24 // indirect
 	github.com/streadway/amqp v0.0.0-20190404075320-75d898a42a94 // indirect
+	github.com/simonswine/vault-plugin-auth-google v0.0.0-20190821152947-bfe2fcafdf08
 	github.com/stretchr/testify v1.3.0
 	go.etcd.io/bbolt v1.3.2
 	go.etcd.io/etcd v0.0.0-20190412021913-f29b1ada1971
diff --git a/go.sum b/go.sum
index 697a6fe42..b449075f3 100644
--- a/go.sum
+++ b/go.sum
@@ -528,6 +528,8 @@ github.com/sean-/seed v0.0.0-20170313163322-e2103e2c3529 h1:nn5Wsu0esKSJiIVhscUt
 github.com/sean-/seed v0.0.0-20170313163322-e2103e2c3529/go.mod h1:DxrIzT+xaE7yg65j358z/aeFdxmN0P9QXhEzd20vsDc=
 github.com/shopspring/decimal v0.0.0-20180709203117-cd690d0c9e24 h1:pntxY8Ary0t43dCZ5dqY4YTJCObLY1kIXl0uzMv+7DE=
 github.com/shopspring/decimal v0.0.0-20180709203117-cd690d0c9e24/go.mod h1:M+9NzErvs504Cn4c5DxATwIqPbtswREoFCre64PpcG4=
+github.com/simonswine/vault-plugin-auth-google v0.0.0-20190821152947-bfe2fcafdf08 h1:SXfBL1oW8O6OA+jZXmzivxOLygfZ8GCVdD13/5mCk7I=
+github.com/simonswine/vault-plugin-auth-google v0.0.0-20190821152947-bfe2fcafdf08/go.mod h1:4ajBhl9pLwjR5gwQ3v8bXNMmZ9pVOGYjcjjGOT+apPE=
 github.com/sirupsen/logrus v1.0.5 h1:8c8b5uO0zS4X6RPl/sd1ENwSkIc0/H2PaHxE3udaE8I=
 github.com/sirupsen/logrus v1.0.5/go.mod h1:pMByvHTf9Beacp5x1UXfOR9xyW/9antXMhjMPG0dEzc=
 github.com/sirupsen/logrus v1.2.0 h1:juTguoYk5qI21pwyTXY3B3Y5cOTH3ZUyZCg1v/mihuo=
diff --git a/helper/builtinplugins/registry.go b/helper/builtinplugins/registry.go
index 876537dc7..34c36b8c8 100644
--- a/helper/builtinplugins/registry.go
+++ b/helper/builtinplugins/registry.go
@@ -22,6 +22,7 @@ import (
 	credOkta "github.com/hashicorp/vault/builtin/credential/okta"
 	credRadius "github.com/hashicorp/vault/builtin/credential/radius"
 	credUserpass "github.com/hashicorp/vault/builtin/credential/userpass"
+	credGoogle "github.com/simonswine/vault-plugin-auth-google/google"
 
 	dbElastic "github.com/hashicorp/vault-plugin-database-elasticsearch"
 	dbCass "github.com/hashicorp/vault/plugins/database/cassandra"
@@ -85,6 +86,7 @@ func newRegistry() *registry {
 			"pcf":        credCF.Factory, // Deprecated.
 			"radius":     credRadius.Factory,
 			"userpass":   credUserpass.Factory,
+			"google":     credGoogle.Factory,
 		},
 		databasePlugins: map[string]BuiltinFactory{
 			// These four plugins all use the same mysql implementation but with
-- 
2.21.0

